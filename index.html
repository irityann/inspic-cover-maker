<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iNSPiC カバーメーカー(非公式)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kiwi+Maru&family=M+PLUS+Rounded+1c:wght@700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'M PLUS Rounded 1c', sans-serif; text-align: center; background: #f0f2f5; padding: 20px; }
        .disclaimer { font-size: 11px; color: #888; margin-bottom: 10px; }
        .canvas-wrapper { display: inline-block; padding: 10px; background: #fff; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 15px; }
        .controls { background: white; padding: 20px; border-radius: 15px; display: inline-block; max-width: 500px; }
        .control-group { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        button { padding: 8px 15px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 5px; font-weight: bold; margin: 3px; }
        input[type="color"] { width: 40px; height: 30px; vertical-align: middle; }
        input[type="text"] { padding: 8px; border: 1px solid #ddd; border-radius: 5px; width: 150px; }
    </style>
</head>
<body>

    <h1>iNSPiC カバーメーカー</h1>
    <p class="disclaimer">※非公式：テキスト追加機能付き</p>
    
    <div class="canvas-wrapper">
        <canvas id="canvas"></canvas>
    </div>

    <div class="controls">
        <div class="control-group">
            背景：<input type="color" id="bgColor" value="#ffffff">
            画像：<input type="file" id="imageInput" accept="image/*">
        </div>

        <div class="control-group">
            <input type="text" id="textInput" placeholder="文字を入力">
            <button id="addText">文字を追加</button>
            文字色：<input type="color" id="textColor" value="#333333">
        </div>

        <button id="download" style="background: #28a745;">デザインを保存 (PNG)</button>
    </div>

    <script>
        const canvas = new fabric.Canvas('canvas', {
            width: 453, height: 317, backgroundColor: '#ffffff'
        });

        // ガイド線
        const inspicShell = new fabric.Rect({
            left: 0, top: 0, width: 453, height: 317, rx: 20, ry: 20,
            fill: 'transparent', stroke: '#e0e0e0', strokeWidth: 2, selectable: false, evented: false
        });
        const cutLine = new fabric.Rect({
            left: 5, top: 5, width: 443, height: 307, rx: 18, ry: 18,
